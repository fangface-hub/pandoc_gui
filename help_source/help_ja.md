---
lang: ja
---

# PandocGUI ヘルプ

## 概要

PandocGUIは、Pandocを使用してMarkdownファイルをHTMLやその他の形式に変換するためのシンプルなGUIツールです。Luaフィルタを使用して、MermaidやPlantUMLなどの図を自動生成できます。

## 主な機能

- **ファイル/フォルダ変換**: 単一ファイルの変換、またはフォルダ内の複数ファイルを一括処理
- **Luaフィルタ**: diagram.luaなどのフィルタを適用して図を生成
- **CSSスタイル**: カスタムスタイルシートの適用（埋め込み/外部リンク）
- **プロファイル管理**: よく使う設定を保存・読み込み
- **除外パターン**: フォルダ変換時に特定のファイルをスキップ
- **ログ表示**: 変換の進行状況とエラーを監視

## 基本的な使い方

### 1. 入力の選択

**ファイルを変換する場合:**

1. 「ファイル選択」ボタンをクリック
2. 変換したいMarkdownファイル（.md）を選択

**フォルダを一括変換する場合:**

1. 「フォルダ選択」ボタンをクリック
2. Markdownファイルが含まれるフォルダを選択
3. サブフォルダ内のファイルも自動的に処理されます

### 2. 出力先の設定

1. 「出力先選択」ボタンをクリック
2. 変換後のファイルを保存するフォルダを選択

### 3. フィルタの設定

**プリセットフィルタを追加:**

1. 「プリセットフィルタ」ドロップダウンから選択
2. 「追加」ボタンをクリック

**ユーザーフィルタを追加:**

1. 「参照」ボタンをクリックして`.lua`ファイルを選択
2. 「追加」ボタンをクリック

**フィルタの順序変更:**

- フィルタリストの項目を選択
- 「↑」「↓」ボタンで順序を調整

**フィルタの削除:**

- フィルタリストの項目を選択
- 「削除」ボタンをクリック

### 4. CSSスタイルの設定

1. 「CSSスタイルシート設定」ボタンをクリック
2. CSSファイルを選択
3. 適用方法を選択：
   - **埋め込み**: CSSをHTMLファイル内に埋め込む
   - **外部リンク**: 別ファイルとして出力し、HTMLからリンク

### 5. 除外パターンの設定（フォルダ変換時）

フォルダ変換時に特定のファイルをスキップするには:

1. 「除外パターン管理」ボタンをクリック
2. 除外パターンウィンドウが開く
3. パターンを入力（1行に1つ）
4. 「OK」をクリック

**パターンの例:**

```text
*.tmp
__pycache__
.git
test_*
*_backup
node_modules
```

### 6. 変換の実行

1. すべての設定を確認
2. 「変換実行」ボタンをクリック
3. ログウィンドウで進行状況を確認

## プロファイル機能

よく使う設定の組み合わせをプロファイルとして保存できます。

### プロファイルの保存

1. 設定を調整
2. 「プロファイル保存」ボタンをクリック
3. プロファイル名を入力
4. 「OK」をクリック

### プロファイルの読み込み

1. 「プロファイル読み込み」ボタンをクリック
2. リストからプロファイルを選択
3. 「OK」をクリック

保存されたプロファイルは`profiles/`フォルダにJSON形式で保存されます。

## PlantUML / Java の設定

PlantUML図を使用する場合、パスは以下の優先順位で検索されます:

### PlantUML JARファイル

1. ドキュメントのYAMLメタデータ `plantuml_jar`
2. 環境変数 `PLANTUML_JAR`
3. デフォルト値 `plantuml.jar`

### Java実行ファイル

1. ドキュメントのYAMLメタデータ `java_path`
2. 環境変数 `JAVA_PATH`
3. 環境変数 `JAVA_HOME\bin\java`
4. PATHから`java`

### 環境変数の設定例

**PowerShell:**

```powershell
$env:PLANTUML_JAR = 'C:\tools\plantuml.jar'
$env:JAVA_PATH = 'C:\Program Files\Java\jdk-17\bin\java.exe'
```

**コマンドプロンプト:**

```bat
set PLANTUML_JAR=C:\tools\plantuml.jar
set JAVA_PATH=C:\Program Files\Java\jdk-17\bin\java.exe
```

### YAMLメタデータでの指定

Markdownファイルの先頭に追加:

```yaml
---
plantuml_jar: C:\tools\plantuml.jar
java_path: C:\Program Files\Java\jdk-17\bin\java.exe
---
```

## トラブルシューティング

### 変換が失敗する

**確認事項:**

- Pandocがインストールされ、PATHに追加されているか？
- 入力ファイルが正しいMarkdown形式か？
- 出力フォルダへの書き込み権限があるか？

**ログを確認:**

- GUIのログウィンドウでエラーメッセージを確認
- `pandoc.log`ファイルで詳細を確認

### 図が生成されない

**Mermaid図の場合:**

- `mmdc`（mermaid-cli）がインストールされているか確認
- コマンドプロンプトで`mmdc --version`を実行して確認

**PlantUML図の場合:**

- `plantuml.jar`が存在するか確認
- Javaがインストールされているか確認
- 環境変数またはYAMLメタデータでパスを指定

### フィルタが適用されない

**確認事項:**

- フィルタが正しく追加されているか？（フィルタリストを確認）
- Luaファイルが正しいパスで存在するか？
- フィルタの順序は適切か？（diagram.luaは特定の順序が必要な場合がある）

### 除外パターンが機能しない

**確認事項:**

- パターンの構文は正しいか？（ワイルドカード`*`を使用）
- パターンがファイル名またはフォルダ名と一致しているか？
- 除外パターンウィンドウで「OK」をクリックして保存したか？

## よくある質問

### Q: どのファイル形式に変換できますか？

A: Pandocがサポートするすべての形式に変換できます。主なものは:

- HTML
- PDF（LaTeXが必要）
- DOCX（Word）
- EPUB
- その他多数

出力形式はPandocオプションで指定できます（将来のバージョンで対応予定）。

### Q: 複数のCSSファイルを使用できますか？

A: 現在のバージョンでは1つのCSSファイルのみサポートしています。複数のスタイルが必要な場合は、CSSファイルを結合してください。

### Q: フォルダ変換時にファイル構造は保持されますか？

A: はい、入力フォルダのサブフォルダ構造は出力先でも保持されます。

### Q: 変換をキャンセルできますか？

A: ウィンドウを閉じることで変換プロセスを安全に終了できます。処理中のファイルは完了しますが、残りのファイルはキャンセルされます。

## ログファイル

変換の詳細は以下のログファイルに記録されます:

- **場所**: `pandoc.log`（実行ファイルと同じフォルダ）
- **内容**: Pandocの出力、エラーメッセージ、フィルタ実行結果

問題が発生した場合は、このログファイルを確認してください。

## 付録: フィルタについて

### プリセットフィルタ

`filters/`フォルダに配置されたLuaフィルタは自動的に検出されます。

**diagram.lua:**

- Mermaid、PlantUMLなどのコードブロックを図に変換

**md2html.lua:**

- Markdown内で追加の処理を実行

**wikilink.lua:**

- Wiki形式のリンクを変換

### カスタムフィルタの追加

1. 任意の場所に`.lua`ファイルを作成
2. 「ユーザーフィルタ」セクションの「参照」ボタンをクリック
3. 作成したLuaファイルを選択
4. 「追加」ボタンをクリック

## サポート情報

問題が解決しない場合は、以下の情報とともに報告してください:

- 使用しているPandocGUIのバージョン
- Pandocのバージョン（`pandoc --version`）
- エラーメッセージ（ログウィンドウまたは`pandoc.log`から）
- 実行した手順
- サンプル入力ファイル（可能であれば）

---

**PandocGUI** - Pandoc用シンプルGUIフロントエンド  
バージョン 1.0
