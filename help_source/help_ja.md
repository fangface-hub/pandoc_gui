---
lang: ja
---

# PandocGUI ヘルプ

## 概要

PandocGUIは、Pandocを使用してMarkdownファイルをHTMLやその他の形式に変換するためのシンプルなGUIツールです。Luaフィルタを使用して、MermaidやPlantUMLなどの図を自動生成できます。

## 主な機能

- **ファイル/フォルダ変換**: 単一ファイルの変換、またはフォルダ内の複数ファイルを一括処理
- **Luaフィルタ**: diagram.luaなどのフィルタを適用して図を生成
- **CSSスタイル**: カスタムスタイルシートの適用（埋め込み/外部リンク）
- **プロファイル管理**: よく使う設定を保存・読み込み
- **除外パターン**: フォルダ変換時に特定のファイルをスキップ
- **ログ表示**: 変換の進行状況とエラーを監視

## 基本的な使い方

### 1. 入力の選択

**ファイルを変換する場合:**

1. 「ファイル選択」ボタンをクリック
2. 変換したいMarkdownファイル（.md）を選択

**フォルダを一括変換する場合:**

1. 「フォルダ選択」ボタンをクリック
2. Markdownファイルが含まれるフォルダを選択
3. サブフォルダ内のファイルも自動的に処理されます

### 2. 出力先の設定

1. 「出力先選択」ボタンをクリック
2. 変換後のファイルを保存するフォルダを選択

### 3. フィルタの設定

**プリセットフィルタを追加:**

1. 「プリセットフィルタ」ドロップダウンから選択
2. 「追加」ボタンをクリック

**ユーザーフィルタを追加:**

1. 「参照」ボタンをクリックして`.lua`ファイルを選択
2. 「追加」ボタンをクリック

**フィルタの順序変更:**

- フィルタリストの項目を選択
- 「↑」「↓」ボタンで順序を調整

**フィルタの削除:**

- フィルタリストの項目を選択
- 「削除」ボタンをクリック

### 4. CSSスタイルの設定

1. 「CSSスタイルシート設定」ボタンをクリック
2. CSSファイルを選択
3. 適用方法を選択：
   - **埋め込み**: CSSをHTMLファイル内に埋め込む
   - **外部リンク**: 別ファイルとして出力し、HTMLからリンク

### 5. 除外パターンの設定（フォルダ変換時）

フォルダ変換時に特定のファイルをスキップするには:

1. 「除外パターン管理」ボタンをクリック
2. 除外パターンウィンドウが開く
3. パターンを入力（1行に1つ）
4. 「OK」をクリック

**パターンの例:**

```text
*.tmp
__pycache__
.git
test_*
*_backup
node_modules
```

### 6. 変換の実行

1. すべての設定を確認
2. 「変換実行」ボタンをクリック
3. ログウィンドウで進行状況を確認

## プロファイル機能

よく使う設定の組み合わせをプロファイルとして保存できます。

### プロファイルの作成

1. 「追加」ボタンをクリック
2. 新しいプロファイル名を入力
3. 「OK」をクリック
4. デフォルトプロファイルの設定がコピーされます

### プロファイルの選択

1. プロファイルドロップダウンから選択
2. 設定が自動的に読み込まれます

### プロファイルの保存

1. 設定を調整
2. プロファイルドロップダウンから対象のプロファイルを選択
3. 「保存」ボタンをクリック
4. 現在の設定がプロファイルに保存されます

### プロファイルの削除

1. プロファイルドロップダウンから削除したいプロファイルを選択
2. 「削除」ボタンをクリック
3. 確認ダイアログで「はい」をクリック

**注意:** デフォルトプロファイルは削除できません。

### プロファイルの更新

1. 「読み込み」ボタンをクリック
2. プロファイルが最新の設定項目で更新されます（後方互換性対応）

保存されたプロファイルは`profiles/`フォルダにJSON形式で保存されます。

## PlantUML / Java の設定

PlantUML図を使用する場合、2つの実行方法があります。

### PlantUML実行方法の選択

**JAR方式（ローカル実行）:**

1. 「実行方法」で「JARファイル」を選択
2. Java実行ファイルのパスを指定
3. PlantUML JARファイルのパスを指定

**サーバ方式（オンライン実行）:**

1. 「実行方法」で「サーバ」を選択
2. PlantUMLサーバURLを指定（デフォルト: http://www.plantuml.com/plantuml）
3. Java/JARファイルは不要

### PlantUML JAR方式の設定

パスは以下の優先順位で検索されます:

#### PlantUML JARファイル

1. GUI設定のパス
2. ドキュメントのYAMLメタデータ `plantuml_jar`
3. 環境変数 `PLANTUML_JAR`
4. デフォルト値 `plantuml.jar`

#### Java実行ファイル

1. GUI設定のパス
2. ドキュメントのYAMLメタデータ `java_path`
3. 環境変数 `JAVA_PATH`
4. 環境変数 `JAVA_HOME\bin\java`
5. PATHから`java`

### 環境変数の設定例

**PowerShell:**

```powershell
$env:PLANTUML_JAR = 'C:\tools\plantuml.jar'
$env:JAVA_PATH = 'C:\Program Files\Java\jdk-17\bin\java.exe'
```

**コマンドプロンプト:**

```bat
set PLANTUML_JAR=C:\tools\plantuml.jar
set JAVA_PATH=C:\Program Files\Java\jdk-17\bin\java.exe
```

### YAMLメタデータでの指定

Markdownファイルの先頭に追加:

```yaml
---
plantuml_jar: C:\tools\plantuml.jar
java_path: C:\Program Files\Java\jdk-17\bin\java.exe
---
```

**サーバ方式を使用する場合:**

```yaml
---
plantuml_server: true
plantuml_server_url: http://www.plantuml.com/plantuml
---
```

## 自動更新機能

アプリケーションをアップデートすると、以下のファイルが自動的に更新されます:

### フィルタファイル

- `filters/`フォルダ内の組み込みフィルタ（diaglam.lua、md2html.lua、wikilink.lua）
- アップデート時に最新版に自動更新
- ユーザーが追加したカスタムフィルタは保護されます

### プロファイル設定

- 新しいバージョンで追加された設定項目は自動的に補完されます
- 既存の設定は保持されます
- デフォルト値は`profiles/default.json`から取得されます

## トラブルシューティング

### Pandocが見つからない

**症状:**

- 起動時に警告ダイアログが表示される
- 変換が実行できない

**解決方法:**

1. Pandocをインストール: https://pandoc.org/installing.html
2. インストール後、PATHに追加されているか確認
3. コマンドプロンプトで`pandoc --version`を実行して確認

### 変換が失敗する

**確認事項:**

- Pandocがインストールされ、PATHに追加されているか？
- 入力ファイルが正しいMarkdown形式か？
- 出力フォルダへの書き込み権限があるか？

**ログを確認:**

- GUIのログウィンドウでエラーメッセージを確認
- `pandoc.log`ファイルで詳細を確認

### 図が生成されない

**Mermaid図の場合:**

- `mmdc`（mermaid-cli）がインストールされているか確認
- コマンドプロンプトで`mmdc --version`を実行して確認

**PlantUML図の場合:**

**JAR方式:**
- `plantuml.jar`が存在するか確認
- Javaがインストールされているか確認
- GUI設定または環境変数、YAMLメタデータでパスを指定

**サーバ方式:**
- インターネット接続を確認
- サーバURLが正しいか確認（デフォルト: http://www.plantuml.com/plantuml）
- ファイアウォール設定を確認

### フィルタが適用されない

**確認事項:**

- フィルタが正しく追加されているか？（フィルタリストを確認）
- Luaファイルが正しいパスで存在するか？
- フィルタの順序は適切か？（diagram.luaは特定の順序が必要な場合がある）

### 除外パターンが機能しない

**確認事項:**

- パターンの構文は正しいか？（ワイルドカード`*`を使用）
- パターンがファイル名またはフォルダ名と一致しているか？
- 除外パターンウィンドウで「OK」をクリックして保存したか？

## よくある質問

### Q: どのファイル形式に変換できますか？

A: Pandocがサポートするすべての形式に変換できます。主なものは:

- HTML
- PDF（LaTeXが必要）
- DOCX（Word）
- EPUB
- その他多数

出力形式はPandocオプションで指定できます（将来のバージョンで対応予定）。

### Q: 複数のCSSファイルを使用できますか？

A: 現在のバージョンでは1つのCSSファイルのみサポートしています。複数のスタイルが必要な場合は、CSSファイルを結合してください。

### Q: フォルダ変換時にファイル構造は保持されますか？

A: はい、入力フォルダのサブフォルダ構造は出力先でも保持されます。

### Q: 変換をキャンセルできますか？

A: ウィンドウを閉じることで変換プロセスを安全に終了できます。処理中のファイルは完了しますが、残りのファイルはキャンセルされます。

## ログファイル

変換の詳細は以下のログファイルに記録されます:

- **場所**: `pandoc.log`（実行ファイルと同じフォルダ）
- **内容**: Pandocの出力、エラーメッセージ、フィルタ実行結果

問題が発生した場合は、このログファイルを確認してください。

## 付録: フィルタについて

### プリセットフィルタ

`filters/`フォルダに配置されたLuaフィルタは自動的に検出されます。

**diagram.lua:**

- Mermaid、PlantUMLなどのコードブロックを図に変換

**md2html.lua:**

- Markdown内で追加の処理を実行

**wikilink.lua:**

- Wiki形式のリンクを変換

### カスタムフィルタの追加

1. 任意の場所に`.lua`ファイルを作成
2. 「ユーザーフィルタ」セクションの「参照」ボタンをクリック
3. 作成したLuaファイルを選択
4. 「追加」ボタンをクリック

## サポート情報

問題が解決しない場合は、以下の情報とともに報告してください:

- 使用しているPandocGUIのバージョン
- Pandocのバージョン（`pandoc --version`）
- エラーメッセージ（ログウィンドウまたは`pandoc.log`から）
- 実行した手順
- サンプル入力ファイル（可能であれば）

---

**PandocGUI** - Pandoc用シンプルGUIフロントエンド
